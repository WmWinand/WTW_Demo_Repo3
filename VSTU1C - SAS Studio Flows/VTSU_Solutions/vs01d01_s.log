506  %studio_hide_wrapper;
582  
583  %studio_hide_wrapper;
591  
592  
593  %macro _flw_action_start(nodes);
594      data _null_;
595          dtEndStr = put(datetime(), E8601DZ.);
596          put "_FLW_ACTION_START_|" dtEndStr +(-1) "|&nodes";
597      run;
598  %mend _flw_action_start;
599  %macro _flw_action_end(nodes, table_libs, libs, table_names);
600      data _null_;
601  
602          attrib next_table_name length = $32 informat = $32. format = $32.
603                 dtStartStr length = $26 informat = $26. format = $26.;
604  
605          %local i next_table;
606          %do i=1 %to %sysfunc(countc(&table_libs, |)) + 1;
607              %let next_table = %qscan(&table_libs, &i, |);
608              %let next_lib = %qscan(&libs, &i, |);
609              %let next_table_name = %qscan(&table_names, &i, |);
610              next_table_name = kreverse(ksubstr(kreverse(ksubstr(kstrip("&next_table_name."),2)),2));
611              %let table_exists = %eval(%sysfunc(exist(&next_table, data)) or %sysfunc(exist(&next_table, view)));
612              put "_FLW_ACTION_TABLE_|&next_lib|" next_table_name +(-1) "|&table_exists";
613          %end;
614          dtStartStr = put(datetime(), E8601DZ.);
615          put "_FLW_ACTION_END_|" dtStartStr +(-1) "|&nodes";
616      run;
617  %mend _flw_action_end;
618  
619  %_flw_action_start(id-1625246933782-343);

_FLW_ACTION_START_|2021-08-05T10:49:32+00:00|id-1625246933782-343
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

620  /*===========================================================================*
621  * Node name:        Import Quakes
622  * Node ID:          id-1625246933782-343
623  *
624  * Input Files:
625  *   /home/student/Courses/VSTU_data/quakes.csv
626  *
627  * Output Tables:
628  *   WORK.quakes
629  *
630  * Step name:        Import
631  * Step URI:         /dataFlows/steps/d38ccdec-66bc-43d0-84f0-faf8d5812bad
632  * Step description: Import transform; used to import excel files into SAS
633  *----------------------------------------------------------------------------*/
634  
635  
636  %LET global_validvarname = %sysfunc(getoption(validvarname));
637  OPTIONS VALIDVARNAME=V7;
638  
639  FILENAME _flw_fr "/home/student/Courses/VSTU_data/quakes.csv";
640  /* Delete table WORK.quakes */
641  proc datasets library = WORK memtype = (data view) nolist nowarn;
642     delete quakes;
643  quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

644  
645  data WORK.quakes;
646  
647     attrib
648     Latitude length = 8 format = BEST12. informat = BEST32. label = "Latitude"
649     Longitude length = 8 format = BEST12. informat = BEST32. label = "Longitude"
650     Depth length = 8 format = BEST12. informat = BEST32. label = "Depth"
651     Magnitude length = 8 format = BEST12. informat = BEST32. label = "Magnitude"
652     Class length = $8 format = $8. informat = $8. label = "Class"
653     dNearestStation length = 8 format = BEST12. informat = BEST32. label = "dNearestStation"
654     RootMeanSquareTime length = 8 format = BEST12. informat = BEST32. label = "RootMeanSquareTime"
655     Type length = $10 format = $10. informat = $10. label = "Type";
656  
657     infile _flw_fr
658     lrecl = 32767
659     encoding ="UTF-8"
660     delimiter = ','
661     firstobs = 2
662     dsd
663     missover;
664  
665     input
666     Latitude
667     Longitude
668     Depth
669     Magnitude
670     Class
671     dNearestStation
672     RootMeanSquareTime
673     Type;
674  RUN;

NOTE: The infile _FLW_FR is:
      Filename=/home/student/Courses/VSTU_data/quakes.csv,
      Owner Name=root,Group Name=root,
      Access Permission=-rw-r--r--,
      Last Modified=27Jul2021:17:03:49,
      File Size (bytes)=713747

NOTE: 15507 records were read from the infile _FLW_FR.
      The minimum record length was 32.
      The maximum record length was 64.
NOTE: The data set WORK.QUAKES has 15507 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.13 seconds
      cpu time            0.12 seconds
      

675  
676  FILENAME _flw_fr CLEAR;
NOTE: Fileref _FLW_FR has been deassigned.
677  OPTIONS VALIDVARNAME=&global_validvarname;
678  
679  
680  %_flw_action_end(id-1625246933782-343, WORK.quakes, WORK, "quakes");

_FLW_ACTION_TABLE_|WORK|quakes|1
_FLW_ACTION_END_|2021-08-05T10:49:32+00:00|id-1625246933782-343
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

681  
682  %_flw_action_start(id-1625247051919-1842);

_FLW_ACTION_START_|2021-08-05T10:49:32+00:00|id-1625247051919-1842
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

683  /*===========================================================================*
684  * Node name:        Magnitude 6 or Greater
685  * Node ID:          id-1625247051919-1842
686  *
687  * Input Tables:
688  *   WORK.quakes
689  *
690  * Output Tables:
691  *   WORK.strong_quakes
692  *
693  * Step name:        Filter Rows
694  * Step URI:         /dataFlows/steps/29351cc4-ab8e-40ed-804b-109f0b5a9b93
695  * Step description: Filter rows
696  *----------------------------------------------------------------------------*/
697  
698  
699  
700  /* Delete table WORK.strong_quakes */
701  proc datasets library = WORK memtype = (data view) nolist nowarn;
702     delete strong_quakes;
703  quit;

NOTE: PROCEDURE DATASETS used (Total process time):
      real time           0.00 seconds
      cpu time            0.01 seconds
      

704  
705  data WORK.strong_quakes;
706     set WORK.quakes;
707     where Magnitude ge 6;
708  run;

NOTE: There were 12 observations read from the data set WORK.QUAKES.
      WHERE Magnitude>=6;
NOTE: The data set WORK.STRONG_QUAKES has 12 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

709  
710  %_flw_action_end(id-1625247051919-1842, WORK.strong_quakes, WORK, "strong_quakes");

_FLW_ACTION_TABLE_|WORK|strong_quakes|1
_FLW_ACTION_END_|2021-08-05T10:49:32+00:00|id-1625247051919-1842
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

711  
712  %_flw_action_start(id-1625247137922-2979);

_FLW_ACTION_START_|2021-08-05T10:49:32+00:00|id-1625247137922-2979
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

713  /*===========================================================================*
714  * Node name:        Export as XLSX File
715  * Node ID:          id-1625247137922-2979
716  *
717  * Input Tables:
718  *   WORK.strong_quakes
719  *
720  * Output Tables:
721  *   /home/student/Courses/VSTU_data/strong_quakes.xlsx
722  *
723  * Step name:        Export
724  * Step URI:         /dataFlows/steps/da1549ad-a598-4600-9459-97a9f26d07fc
725  * Step description: Export step; used to export Excel and Delimited files from SAS
726  *----------------------------------------------------------------------------*/
727  
728  
729  
730  FILENAME _flw_fr "/home/student/Courses/VSTU_data/strong_quakes.xlsx";
731  
732  proc export data = WORK.strong_quakes outfile = _flw_fr dbms = XLSX replace;
733    sheet = "Sheet1";
734  
735    putNames = YES;
736  run;

NOTE: The export data set has 12 observations and 8 variables.
NOTE: "_FLW_FR" file was successfully created.
NOTE: PROCEDURE EXPORT used (Total process time):
      real time           0.07 seconds
      cpu time            0.02 seconds
      

737  FILENAME _flw_fr CLEAR;
NOTE: Fileref _FLW_FR has been deassigned.
738  
739  
740  %_flw_action_end(id-1625247137922-2979, , , );

_FLW_ACTION_TABLE_|| |1
_FLW_ACTION_END_|2021-08-05T10:49:32+00:00|id-1625247137922-2979
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

741  
742  %_flw_action_start(id-1625247355953-4551);

_FLW_ACTION_START_|2021-08-05T10:49:32+00:00|id-1625247355953-4551
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

743  /*===========================================================================*
744  * Node name:        Map of Strong Quakes
745  * Node ID:          id-1625247355953-4551
746  *
747  * Input Tables:
748  *   WORK.strong_quakes
749  *
750  * Output Tables:
751  *   WORK._flw_487434c7f5fc11eb9af70ed9527
752  *
753  * Step name:        SAS Program
754  * Step URI:         /dataFlows/steps/a7190700-f59c-4a94-afe2-214ce639fcde
755  * Step description: Run user written SAS code.
756  *----------------------------------------------------------------------------*/
757  
758  
759  %let _inputCount = 1;
760  %let _outputCount = 1;
761  %let _input1 = WORK.strong_quakes;
762  %let _output1 = WORK._flw_487434c7f5fc11eb9af70ed9527;
763  
764  ods graphics / reset width=6.4in height=4.8in;
765  
766  proc sgmap plotdata=&_input1;
767  	openstreetmap;
768  	title height=16pt 'Earthquake Locations';
769  	bubble x=Longitude y=Latitude size=Magnitude/ group=Class transparency=0.63
770  		name="bubblePlot";
771  	keylegend "bubblePlot" / title='Class';
772  run;

NOTE: PROCEDURE SGMAP used (Total process time):
      real time           3.93 seconds
      cpu time            0.13 seconds
      
NOTE: There were 12 observations read from the data set WORK.STRONG_QUAKES.

773  
774  ods graphics / reset;
775  title;
776  
777  %symdel _inputCount;
778  %symdel _outputCount;
779  %symdel _input1;
780  %symdel _output1;
781  
782  
783  
784  %_flw_action_end(id-1625247355953-4551, WORK._flw_487434c7f5fc11eb9af70ed9527, WORK, "_flw_487434c7f5fc11eb9af70ed9527");

_FLW_ACTION_TABLE_|WORK|_flw_487434c7f5fc11eb9af70ed9527|0
_FLW_ACTION_END_|2021-08-05T10:49:36+00:00|id-1625247355953-4551
NOTE: DATA statement used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

785  
786  %sysmacdelete _flw_action_start;
787  %sysmacdelete _flw_action_end;
788  
789  
790  %studio_hide_wrapper;
802  
803  

